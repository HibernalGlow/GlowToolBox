import re

# å®šä¹‰ä½ çš„æ–‡ä»¶è·¯å¾„
file_path = r'D:\1STUDY\3-Resource\NBU\æ•™æ\ç›®å½•\1.md'  # æˆ–è€… 'path_to_your_file.txt'

# å®šä¹‰ä½ çš„æ­£åˆ™æ›¿æ¢è§„åˆ™
patterns_and_replacements = [
    # (r'^#{1,6} ',r''),
    (r'^ ',r''),
    (r'(\d)\s+([\u4e00-\u9fa5])',r'\1\2'),
    (r'([\u4e00-\u9fa5])\s+(\d)',r'\1\2'),
    (r'(\d)\s+(\d)',r'\1\2'),
    (r'([\u4e00-\u9fa5])\s+([\u4e00-\u9fa5])',r'\1\2'),#æ±‰å­—å†…ç©ºæ ¼

    # (r'\[\d+\]\(#.+?\)', ''),
    # (r'\d', ''),
    # (r'\\*', r''),#\\
    # (r'^.*?ç›®å½•.*$\n?', r''),#åˆ é™¤åŒ…å«æŸä¸ªå­—ç¬¦
    # (r'\*', r''),#\*
    # (r'!\[+\]+(\(.*\))', r''),#æ›¿æ¢å›¾ç‰‡
    # (r'((?<=\S|^)!\[.*?\]\(.*?\)(?=\S|$))', r'\1\n'),#å›¾ç‰‡+\n
    # (r'> ',r''),#æ›¿æ¢å¼•è¿°
    # (r'>',r''),#æ›¿æ¢å¼•è¿°
    (r'ï¼ˆ',r'('),#æ›¿æ¢å¼•è¿°
    (r'ï¼‰',r')'),#æ›¿æ¢å¼•è¿°
    (r'</body></html> ',r''),
    (r'<html><body>',r''),
    (r'ã€Œ',r'['),
    (r'ã€',r']'),
    (r'ã€',r'['),
    (r'ã€‘',r']'),
    

    (r'\|\n([^|])',r'|\n\n\1'),#è¡¨æ ¼æœ€åä¸€è¡ŒåŠ \n
    (r'^\|(.*?)\|\|\|{1,99}',r'\n\1'),
    # (r'\[TABLE\]',r''),#æ›¿æ¢\[TABLE\]
    #  --- ||
    # (r'^ç¬¬([\u4e00-\u9fa5A-Za-z0-9]+)è®²', r'# ç¬¬\1è®² '),
    # (r'^ç¬¬([\u4e00-\u9fa5A-Za-z0-9]+)éƒ¨åˆ†', r'# ğŸŒŸç¬¬\1éƒ¨åˆ†'),
    # (r'^.*?ç›®å½•.*$\n?', r'\n'),
    # (r'^ç¬¬([\u4e00-\u9fa5A-Za-z0-9]+)ç« ', r'# ç¬¬\1ç«  '),
    # (r'^ç¬¬([\u4e00-\u9fa5A-Za-z0-9]+)ç¼–', r'# ç¬¬\1ç¼– '),
    (r'^ç¬¬([\u4e00-\u9fa5A-Za-z0-9]+)èŠ‚', r'## ç¬¬\1èŠ‚ '),
    (r'^ç¬¬([\u4e00-\u9fa5A-Za-z0-9]+)ç±»', r'## ç¬¬\1ç±» '),
    # (r'^ä¸“é¢˜([\u4e00-\u9fa5A-Za-z0-9]+)', r'# ä¸“é¢˜\1 '),
    # (r'^(ä¸€|äºŒ|ä¸‰|å››|äº”|å…­|ä¸ƒ|å…«|ä¹|å|åä¸€|åäºŒ|åä¸‰|åå››)ã€', r'### \1ã€'),
    # (r'^\((ä¸€|äºŒ|ä¸‰|å››|äº”|å…­|ä¸ƒ|å…«|ä¹|å|åä¸€|åäºŒ|åä¸‰|åå››)\)',r'#### (\1) '),
    # (r'^(\d)\.',r'#### \1.'),
    # (r'^åºè¨€',r'## åºè¨€'),
    # (r'(^\(\d+\)[^()]*)',r'**\1**'),#uæ…ç”¨ï¼Œ6çº§æ ‡é¢˜å(1)çš„å°æ ‡é¢˜åŠ ç²—
    # (r'#####\s*(\d+\.\s*.+)\n\n##### ',r'\1\n'),#ç”¨è¿ç»­åŒçº§æ ‡é¢˜é˜²æ¼
    # (r'####\s*(\((ä¸€|äºŒ|ä¸‰|å››|äº”|å…­|ä¸ƒ|å…«|ä¹)\)\s*.+)\n\n#### ',r'\1\n'),
    (r'(# .*)(\d\.)', r'\1\n\n\2 '),
    
    # (r'^(\d+)\.',r'\1. '),
    # åŠ ç©ºæ ¼.py
    # (r'^\((\d+)\)',r'\1. '),#(1)å˜åˆ—è¡¨
    # (r'(?<=\D)(\d+)\.',r'\n\n\1. '),#æ…ç”¨ï¼Œä¼šå½±å“è¡¨æ ¼å’Œå›¾ç‰‡ éå¼€å¤´1.å˜åˆ—è¡¨
    # (r'(#{1,6} .*?ã€‚)',r'\1\n\n'),#æ…ç”¨ï¼Œæ¯ä¸ªæ ‡é¢˜è¡Œä¹‹åï¼Œé¦–æ¬¡å‡ºç°çš„ä¸­æ–‡å¥å·ï¼ˆã€‚ï¼‰å¤„æ·»åŠ æ¢è¡Œç¬¦
    # (r'(\n+)', r'\n\n'),
    
    # (r'([\u4e00-\u9fa5A-Za-z0-9]+)\n    ([\u4e00-\u9fa5A-Za-z0-9]+)', r'\1\2'),
    (r'(?:\r?\n){3,}', r'\n'),#è¿ç»­3ç©ºè¡Œ
    # (r'([\u4e00-\u9fa5A-Za-z0-9]+)#', r'\1\n\n#'),#è¿ç»­3ç©ºè¡Œ
    # (r'ç« ',r'ç«  '),
    # (r'èŠ‚',r'èŠ‚ '),
    # (r'^.*å¾®ä¿¡.*$\n?',r'')#æ›¿æ¢å…³é”®å­—â—è¡Œ
    # æ›´å¤šçš„æ¨¡å¼å’Œæ›¿æ¢å¯¹...
    # (r'\$\\rightarrow\$',r'â†’'),
    # (r'\$\\leftarrow\$',r'â†'),
    # (r'^\[([\u4e00-\u9fa5A-Za-z0-9]+)\]',r'`[\1]`'),
    # (r'\$=\$',r'='),
    # (r'^ç¬¬(ä¸€|äºŒ|ä¸‰|å››|äº”|å…­|ä¸ƒ|å…«|ä¹)',r'* ç¬¬\1'),
    # (r'\n\n#',r'\n#'),
    # (r'\]`\n{2,5}',r']`'),
    # (r'\$\\mathrm\{([a-z])\}\$',r'\1'),
    # (r'\{[^{}]*id=[^{}]*\}',r''),
    # (r'\| :---: \|(\n\|.*\|$\n)\| :---: \|.*\|$\n',r'| :---: |\1'),#è¡¨æ ¼åˆ†å‰²çº¿å¤šäº†
    
]

# è¯»å–æ–‡ä»¶å†…å®¹
with open(file_path, 'r', encoding='utf-8') as file:
    text = file.read()

# å¯¹æ–‡æœ¬è¿›è¡Œæ­£åˆ™æ›¿æ¢
for pattern, replacement in patterns_and_replacements:
    text = re.sub(pattern, replacement, text, flags=re.MULTILINE)

# å°†æ›¿æ¢åçš„å†…å®¹å†™å›æ–‡ä»¶ï¼ˆå‡è®¾æ˜¯åŸåœ°æ›¿æ¢ï¼‰
with open(file_path, 'w', encoding='utf-8') as file:
    file.write(text)
# print(text)